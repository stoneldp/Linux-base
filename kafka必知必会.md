## Kafka必知必会
### 1、为什么有消息系统
- 一、解耦合
- 二、异步处理
  - 例如：电商平台，秒杀活动。
  - 一般流程分为：
    - 1.风险控制
    - 2.库存锁定
    - 3.生成订单
    - 4.短信通知
    - 5.更新数据
- 三、通过消息系统将秒杀活动业务拆开，将不急需处理的业务放在后面慢慢处理。
  - 流程改为：
    - 1.风险控制
    - 2.库存锁定
    - 3.消息系统
    - 4.生成订单
    - 5.短信通知
    - 6.更新数据
- 四、流量的控制
  - 1.网关在接收到请求后，就把请求放入消息队列里面
  - 2.后端的服务从消息队列里面获取到请求，完成后续的秒杀处理流程。然后再给用户返回结果。
  - **优点：**控制了流量。
  - **缺点：**会让流程变慢。
- 五、延时队列
  - 例如：玩家初始化后要1min内加入对局，可以在玩家初始化时推送消息到延迟队列，延迟1min,然后消费者检查该玩家是否加入对局。
### 2、Kafka基础
- 首先Kafka是一套流式处理系统，可以让后端服务轻松的相互沟通，是服务架构中常用的组件。
- ![](https://github.com/stoneldp/Linux-base/blob/master/photo/%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E9%97%B4%E7%9B%B8%E4%BA%92%E6%B2%9F%E9%80%9A.png)
- `Producer and Consumer`
  - **生产者**:是一个给Kafka发送消息的服务，消费者是监听Kafka消息的服务。
  - ![]()
  - 当然，一个服务可以同时作为生产者和消费者。
- `Topic`
  - `Topic`(主题)是生产者给Kafka发生消息的地址，其他消费者可以监听`Topic`接收消息。
  - ![]()
  - 一个服务可以监听多个`Topic`,也可以给多个`Topic`发送消息：
  - ![]()
  - 消费者也可以以组的形式存在，由Kafka路由到组内某个消费者，便于做负载均衡:
  - ![]()
  - `Topic`扮演者消息队列的角色，消息被存储在队列中，且不可修改:
  - ![]()
  - 即使我们的生产者或消费者挂了，消息任然会存储在队列中，不会丢失。
  - 
### 3、Kafka架构
### 4、Kafka为什么性能高
### 5、Kafka数据可靠性
### 6、Kafka调优指南
### 7、Spring是如何整合Kafka